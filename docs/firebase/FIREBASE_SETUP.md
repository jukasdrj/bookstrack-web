# Firebase Authentication Setup Guide

## âœ… Current Status

**Firebase Configuration: COMPLETE** âœ…
**Last Updated:** January 3, 2026

The BooksTrack web app is now fully configured with Firebase authentication and ready for deployment!

---

## ğŸ”¥ Firebase Project Details

**Project:** flutter-books-857d3
**Project Number:** 989217966501

**Registered Apps:**
- âœ… **Web** - `books_tracker (web)` - App ID: `1:989217966501:web:7bc38d14d5da907615c04c`
- âœ… **Android** - `books_tracker (android)` - App ID: `1:989217966501:android:c48d829b7c87b78215c04c`
- âœ… **iOS** - `books_tracker (ios)` - App ID: `1:989217966501:ios:af41fa31690b897c15c04c`
- âš ï¸ **macOS** - Uses same iOS configuration (bundle ID: `com.oooefam.bookstrack`)

---

## ğŸ“‹ Configuration Files

### Generated Files (âœ… Complete)

**1. `lib/firebase_options.dart`** (gitignored)
- Contains platform-specific Firebase configurations
- Real API keys and project IDs configured
- Ready for use in app initialization

**2. `android/app/google-services.json`** (gitignored)
- Android-specific Firebase configuration
- Generated by FlutterFire CLI

**3. `ios/Runner/GoogleService-Info.plist`** (gitignored)
- iOS-specific Firebase configuration
- Generated by FlutterFire CLI

**4. `macos/Runner/GoogleService-Info.plist`** (missing - will be created on first macOS build)

---

## ğŸ” Authentication Setup

### Required Steps in Firebase Console

1. **Enable Authentication Methods**
   - Go to [Firebase Console](https://console.firebase.google.com/)
   - Select project: `flutter-books-857d3`
   - Navigate to **Build â†’ Authentication**
   - Click **Get Started** (if not already enabled)
   - Enable sign-in methods:
     - âœ… **Email/Password** - Enable this provider
     - âœ… **Google** - Enable and add support email

2. **Configure Authorized Domains**
   - In Authentication â†’ Settings â†’ Authorized domains
   - Add these domains:
     - âœ… `localhost` (for local development)
     - âœ… `books.oooefam.net` (custom domain)
     - âœ… `bookstrack-web.pages.dev` (Cloudflare Pages)

3. **Set Up Google Sign-In (Optional)**
   - In Google provider settings
   - Add support email address
   - Configure OAuth consent screen if needed

---

## ğŸš€ Deployment Instructions

### Local Development

```bash
# Run with Firebase auth enabled
flutter run -d chrome --target=lib/main_auth.dart

# Or run without auth (for testing UI only)
flutter run -d chrome --target=lib/main.dart
```

### Production Deployment to Cloudflare Pages

```bash
# 1. Build web app with Firebase auth
flutter build web --release --target=lib/main_auth.dart

# 2. Deploy to Cloudflare Pages
npx wrangler pages deploy build/web --project-name=bookstrack-web

# 3. Verify deployment
# Visit: https://books.oooefam.net
# Visit: https://bookstrack-web.pages.dev
```

### Post-Deployment Verification

1. **Test Email/Password Sign Up**
   - Create new account with email/password
   - Verify email verification flow
   - Check Firebase Console for new user

2. **Test Google Sign-In**
   - Click "Sign in with Google"
   - Complete OAuth flow
   - Verify user appears in Firebase Console

3. **Test Session Persistence**
   - Sign in
   - Refresh page
   - Verify user stays signed in

4. **Test Sign Out**
   - Click sign out
   - Verify redirect to auth screen
   - Verify session cleared

---

## ğŸ”’ Security Notes

### API Keys Are Public (By Design)

Firebase web API keys are **intentionally public** and safe to commit to version control. Security is enforced by:

1. **Firestore Security Rules** (server-side)
2. **Firebase Authentication** (user verification)
3. **Authorized Domains** (prevent unauthorized origins)

### What's Gitignored (Properly Configured)

Your `.gitignore` correctly excludes sensitive files:
- âœ… `lib/firebase_options.dart` (line 51) - Contains real API keys
- âœ… `android/app/google-services.json` (line 67)
- âœ… `ios/Runner/GoogleService-Info.plist` (lines 68-69)
- âœ… `macos/Runner/GoogleService-Info.plist` (line 69)

**Note:** While API keys are public, we gitignore config files to prevent accidental exposure of project structure and to maintain clean version control.

---

## ğŸ”§ Firebase Features Included

The app (`lib/main_auth.dart`) includes:

âœ… **Email/Password Authentication**
- Sign up with email validation
- Sign in with error handling
- Password reset functionality

âœ… **Google OAuth Sign-In**
- Popup-based Google sign-in flow
- Seamless user experience

âœ… **Session Management**
- Firebase auth state persistence
- Automatic session restoration
- Secure token management

âœ… **Protected Routes**
- Authentication gate for main app
- Redirect to auth screen when not signed in
- Automatic navigation after sign-in

âœ… **Error Handling**
- User-friendly error messages
- Loading states during auth operations
- Proper error recovery

---

## ğŸ†˜ Troubleshooting

### "Firebase not initialized" Error

**Solution:** Ensure you're running with the correct target:
```bash
flutter run -d chrome --target=lib/main_auth.dart
```

### "Unauthorized domain" Error

**Solution:** Add your domain to Firebase Console â†’ Authentication â†’ Settings â†’ Authorized domains

### Google Sign-In Popup Blocked

**Solution:**
1. Allow popups for your domain in browser settings
2. Ensure `authDomain` is correct in `firebase_options.dart`
3. Verify authorized domains in Firebase Console

### Users Not Appearing in Firebase Console

**Solution:**
1. Check Firebase Console â†’ Authentication â†’ Users
2. Verify Firebase initialization in `main_auth.dart`
3. Check browser console for errors

---

## ğŸ“Š Firebase Console Links

- **Project Overview:** https://console.firebase.google.com/project/flutter-books-857d3
- **Authentication:** https://console.firebase.google.com/project/flutter-books-857d3/authentication/users
- **Settings:** https://console.firebase.google.com/project/flutter-books-857d3/settings/general

---

## ğŸ”„ Regenerating Configuration (If Needed)

If you need to regenerate Firebase configuration:

```bash
# Method 1: FlutterFire CLI (requires xcodeproj gem)
flutterfire configure --project=flutter-books-857d3 \
  --platforms=android,ios,macos,web \
  --yes \
  --out=lib/firebase_options.dart

# Method 2: Manual via Firebase CLI
firebase apps:sdkconfig WEB 1:989217966501:web:7bc38d14d5da907615c04c \
  --project=flutter-books-857d3
```

---

## ğŸ“š Resources

- [FlutterFire Documentation](https://firebase.flutter.dev/)
- [Firebase Console](https://console.firebase.google.com/)
- [Firebase Auth for Web](https://firebase.google.com/docs/auth/web/start)
- [Firebase CLI Reference](https://firebase.google.com/docs/cli)
- [FlutterFire CLI Reference](https://firebase.flutter.dev/docs/cli/)

---

## âœ… Deployment Checklist

Before deploying to production:

- [x] Firebase project created (`flutter-books-857d3`)
- [x] FlutterFire CLI installed
- [x] Firebase configuration generated (`firebase_options.dart`)
- [x] Platform apps registered (Web, Android, iOS)
- [ ] **Authentication providers enabled** (Email/Password, Google)
- [ ] **Authorized domains configured** (localhost, books.oooefam.net, bookstrack-web.pages.dev)
- [ ] Local testing complete
- [ ] Production deployment tested
- [ ] Users can sign up/sign in
- [ ] Session persistence verified

---

**Status:** Configuration complete, pending authentication provider setup in Firebase Console
**Next Steps:**
1. Enable Email/Password authentication in Firebase Console
2. Enable Google sign-in provider
3. Add authorized domains
4. Deploy to production
5. Test authentication flows

**Last Updated:** January 3, 2026
